<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><link rel=prev href=https://younesbelkada.github.io/projects/table-structure/><link rel=next href=https://younesbelkada.github.io/projects/stego-ml/><link rel=canonical href=https://younesbelkada.github.io/projects/pose-socring/><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>An approach for fitness exercise scoring using Deep Learning | Younes Belkada</title><meta name=title content="An approach for fitness exercise scoring using Deep Learning | Younes Belkada"><link rel=stylesheet href=/font/iconfont.css><link rel=stylesheet href=/css/main.min.css><meta name=twitter:card content="summary"><meta name=twitter:title content="An approach for fitness exercise scoring using Deep Learning"><meta name=twitter:description content="Introduction Imagine a world where (almost) everything is powered by Artificial Intelligence. Today, some signs of an Artifical Intelligence-guided society are coming into existence. Autonomous cars can automately drive you from a point A to a point B, and more recently, Tesla has revealed the Tesla Bot, the humanoid robot that will be able to help humans for simple tasks.
Apart from having society full of AI-powered robots, back in 2019 when we have starting the project together with my teammates and the laboratory ISIR from Sobonne University, we just wanted to try to tackle to problematic of having an AI-based gym trainer for fitness exercises."><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"An approach for fitness exercise scoring using Deep Learning","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/younesbelkada.github.io\/projects\/pose-socring\/"},"image":{"@type":"ImageObject","url":"https:\/\/younesbelkada.github.io\/cover.png","width":800,"height":600},"genre":"projects","wordcount":772,"url":"https:\/\/younesbelkada.github.io\/projects\/pose-socring\/","datePublished":"2020-05-24T20:26:19\u002b02:00","dateModified":"2020-05-24T20:26:19\u002b02:00","publisher":{"@type":"Organization","name":"Fastbyte01","logo":{"@type":"ImageObject","url":"https:\/\/younesbelkada.github.io\/logo.png","width":127,"height":40}},"author":{"@type":"Person","name":"Fastbyte01"},"description":""}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=https://younesbelkada.github.io/>Younes Belkada</a></div><div class="menu navbar-right"><a class=menu-item href=/posts/ title>Blog</a>
<a class=menu-item href=/notes/ title>Notes</a>
<a class=menu-item href=/categories/ title>Categories</a>
<a class=menu-item href=/projects/ title>Projects</a>
<a class=menu-item href=/about title>About</a>
<a href=javascript:void(0); class=theme-switch><i class="iconfont icon-sun"></i></a>&nbsp;</div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-sun"></i></a>&nbsp;<a href=https://younesbelkada.github.io/>Younes Belkada</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=/posts/ title>Blog</a>
<a class=menu-item href=/notes/ title>Notes</a>
<a class=menu-item href=/categories/ title>Categories</a>
<a class=menu-item href=/projects/ title>Projects</a>
<a class=menu-item href=/about title>About</a></div></div></nav><main class=main><div class=container><article class=post-warp><header class=post-header><h1 class=post-title>An approach for fitness exercise scoring using Deep Learning</h1><div class=post-meta>Written by <a href=https://younesbelkada.github.io/ rel=author>younesbelkada</a> with ♥
<span class=post-time>on <time datetime=2020-05-24>24 May 2020</time></span>
in
<i class="iconfont icon-folder"></i>
<span class=post-category><a href=https://younesbelkada.github.io/categories/projects/>Projects</a></span>
<i class="iconfont icon-timer"></i>
4 min</div></header><div class=post-content><h1 id=introduction>Introduction</h1><p>Imagine a world where (almost) everything is powered by Artificial Intelligence. Today, some signs of an Artifical Intelligence-guided society are coming into existence. Autonomous cars can automately drive you from a point A to a point B, and more recently, Tesla has revealed the <em><strong>Tesla Bot</strong></em>, <a href=https://usa.inquirer.net/81836/tesla-bot-everything-you-need-to-know>the humanoid robot</a> that will be able to help humans for simple tasks.</p><p><figure><img src=/images/ring.svg data-sizes=auto data-src=/images/projects/Tesla_Bot.png alt="Elon Musk when revealing the Tesla Bot - August 2021 - Source: autoplus.fr " class=lazyload><figcaption class=image-caption>Elon Musk when revealing the Tesla Bot - August 2021 - Source: autoplus.fr</figcaption></figure></p><p>Apart from having society full of AI-powered robots, back in 2019 when we have starting the project together with my teammates and the laboratory <a href=https://www.isir.upmc.fr/>ISIR</a> from Sobonne University, we just wanted to <em><strong>try</strong></em> to tackle to problematic of having an AI-based gym trainer for fitness exercises.</p><h3 id=fitness-exercises-and-ai>Fitness exercises and AI?</h3><p>Fitness exercises consists mostly of repeated movements that needs to be executed in the most accurate way possible to solicit some specific joints and muscles of our body. If an AI <em><strong>learns</strong></em> how a specific exercise needs to be done correclty, given an execution of this exercise the AI should be able to interpret how far this execution it is from the learned execution. The problem seems exetremly straightforward to forumulate but very hard to translate it into a Machine Learning problem.</p><h1 id=challenges>Challenges</h1><h3 id=what-is-going-to-be-the-input-data>What is going to be the input data?</h3><p>If deployed into a real-world application, the input data would clearly be a video. As stated in the previous section, the AI needs to learn how to perform a right execution, which consists of a video of a movement.
Does the AI needs to be end-to-end? (<em><strong>Directly from the video to the score</strong></em>). <em>Not that easy</em>.</p><p>Given the lack (or the inexistence) of a labeled data for this task, the problematic became very challenging but exciting. We had to create a custom dataset by involving staff members from the lab and hard work since we had to label each frame from each video.</p><p>The project&rsquo;s main problematic has rapidly became <em><strong>Can we create an AI that classifies and scores a fitness movement?</strong></em> to <em><strong>Is Deep Learning well adapted to score a movement?</strong></em></p><h3 id=transforming-the-input-into-another-space>Transforming the input into another space</h3><p>Having a model that learns everything end-to-end directly from the video is extremely computationnaly expensive and <strong>not robust in practice</strong>. It can easily overfit into the persons we have used to train the model or overfit to some contextual information we do not have control on (e.g. the background, the lighting of the room in the videos, etc.). Thus, the input data absolulety needs to be transformed in order to make them more understandable for the Deep Learning model to process it, and to avoid our common ennemy: <em>overfitting</em>.</p><p><strong>Long live human poses!</strong> What if we express each frame into only the joints of the person in the video? By doing this, we drastically reduce the amount of data (each frame can be expressed using only 30 data points instead of 3x256 pixels!). Back in 2019, <a href=https://github.com/CMU-Perceptual-Computing-Lab/openpose>OpenPose</a> was the state-of-the-art method for 2D human pose estimation model.</p><p><figure><img src=/images/ring.svg data-sizes=auto data-src=/images/projects/pose_face_hands.gif alt="Qualitative results from OpenPose - Source: OpenPose&rsquo;s official repository" class=lazyload><figcaption class=image-caption>Qualitative results from OpenPose - Source: OpenPose&rsquo;s official repository</figcaption></figure></p><p>This approach to tackle the problem seemed perfect to us. OpenPose was state-of-the-art, time-consistent (consistent results between each frame) and extremly robust since it has been trained on a very large dataset with a wide variety of different people, background images, lighting conditions, etc. In addition, the outputed keypoints can be normalized and the score would be independent to the size of the human, which in practice is the case.</p><h3 id=deal-with-different-numbers-of-frames>Deal with different numbers of frames</h3><p>Each frame is now expressed into a vector of size 30. A video is a concatenation of frames, thus can be expressed with a concatenation of generated vectors. How to deal with inconsitent number of frames accross each video? By just applying a fixed zero-padding on those tensors. Let&rsquo;s assume the maximum number of frames accross all videos is <em>N</em>. Then each video would have a size <em>(30xN)</em> and the irregular videos will be zero-padded.</p><h1 id=implementations>Implementations</h1><p>After manually labelling the data and transforming each video into a <em>(30xN)</em> dimensional tensor we have tried several approaches to output a score given the tensors.</p><p>Each <em>30-dimensional</em> vector is concatenated in the horizontal direction. Arranging the data like the following is similar to having a sequential data where each column corresponds to a specific timestep.</p><h3 id=score-predictor-as-a-1d-cnn>Score predictor as a 1D-CNN</h3><p>The 1-dimensional filter can learn the linear correlation between each joint at each time step.</p><p><figure><img src=/images/ring.svg data-sizes=auto data-src=/images/projects/conv_1D_time.gif alt="Overview of a 1D-CNN applied to text data - Source: cezannec.github.io/ " class=lazyload><figcaption class=image-caption>Overview of a 1D-CNN applied to text data - Source: cezannec.github.io/</figcaption></figure></p><h3 id=score-predictor-as-a-simple-lstm-model>Score predictor as a simple LSTM model</h3><p>It is a common practice in the Deep Learning litterature to use a LSTM model when dealing with sequential data.</p><p><figure><img src=/images/ring.svg data-sizes=auto data-src=/images/projects/lstm.gif alt="Overview of a LSTM model " class=lazyload><figcaption class=image-caption>Overview of a LSTM model</figcaption></figure></p><h1 id=conclusion>Conclusion</h1><ul><li>Trying to have an end-to-end AI is extremely difficult if we want to deploy a robust AI. Breaking down the problem into smaller problems can help and must be considerd.</li></ul></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>younesbelkada</span></p><p class=copyright-item><span>Words:</span>
<span>772</span></p><p class=copyright-item><span>Share:</span>
<span><a href="//twitter.com/share?url=https%3a%2f%2fyounesbelkada.github.io%2fprojects%2fpose-socring%2f&text=An%20approach%20for%20fitness%20exercise%20scoring%20using%20Deep%20Learning&via=" target=_blank title="Share on Twitter"><i class="iconfont icon-twitter"></i></a>
<a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fyounesbelkada.github.io%2fprojects%2fpose-socring%2f" target=_blank title="Share on Facebook"><i class="iconfont icon-facebook"></i></a>
<a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fyounesbelkada.github.io%2fprojects%2fpose-socring%2f&title=An%20approach%20for%20fitness%20exercise%20scoring%20using%20Deep%20Learning" target=_blank title="Share on LinkedIn"><i class="iconfont icon-linkedin"></i></a></span></p><p class=copyright-item>Released under <a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></p></div><div class=post-tags><section><a href=javascript:window.history.back();>Back</a></span> ·
<span><a href=https://younesbelkada.github.io/>Home</a></span></section></div><div class=post-nav><a href=https://younesbelkada.github.io/projects/table-structure/ class=prev rel=prev title="An unsupervised method for table structure recognition"><i class="iconfont icon-dajiantou"></i>&nbsp;An unsupervised method for table structure recognition</a>
<a href=https://younesbelkada.github.io/projects/stego-ml/ class=next rel=next title="A frist approach for steganography using Language Models">A frist approach for steganography using Language Models&nbsp;<i class="iconfont icon-xiaojiantou"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2021 - 2021</span>
<span class=author itemprop=copyrightHolder><a href=https://younesbelkada.github.io/>younesbelkada</a></span></div></footer><link crossorigin=anonymous integrity=sha384-yziQACfvCVwLqVFLqkWBYRO3XeA4EqzfXKGwaWnenYn5XzqfJFlFdKEmvutIQdKb href=https://lib.baomitu.com/lightgallery/1.10.0/css/lightgallery.min.css rel=stylesheet><script src=/js/vendor_gallery.min.js async></script></div></body></html>